---
title: "The Aphasia Communication Outcome Measure (ACOM)"
output: pdf_document
urlcolor: blue
params:
  v: NA
  dt: NA
header-includes:
    - \usepackage{booktabs}
    - \usepackage{tabu}
    - \usepackage{longtable}
    - \usepackage{float}
    - \usepackage[default]{sourcesanspro}
    - \usepackage[T1]{fontenc}
    - \usepackage{xcolor}
    - \usepackage[document]{ragged2e}
---

\raggedright

```{r global_options, include=FALSE}
library(magrittr)
knitr::opts_chunk$set(fig.pos = 'H')
#options(knitr.kable.NA = '-')
shiny::setProgress(0.1)

final = params$v$results %>%
  dplyr::arrange(order) %>%
  tidyr::drop_na(response) %>%
  dplyr::filter(order == max(order, na.rm = TRUE)) %>%
  dplyr::mutate(theta = round(theta, 2), sem = round(sem, 2))

theta = final$theta
sem = final$sem
z = (theta-50)/10
ab = ifelse(z>=0, "above", "below")

x95 = glue::glue("{round(theta-1.96  *sem, 2)}, {round(theta+1.96  *sem, 2)}")
x90 = glue::glue("{round(theta-1.645 *sem, 2)}, {round(theta+1.645 *sem, 2)}")
x68 = glue::glue("{round(theta-1     *sem, 2)}, {round(theta+1     *sem, 2)}")


completed = params$v$results %>%
  dplyr::mutate(theta = round(theta, 2), sem = round(sem, 2)) %>%
  tidyr::drop_na(response)

valid = params$v$results %>%
  dplyr::mutate(theta = round(theta, 2), sem = round(sem, 2)) %>%
  tidyr::drop_na(response_num)

table1 = tibble::tribble(
    ~"label", ~"score",
    "Final T-Score Estimate" , as.character(theta),
    "Final Standard Error"   , as.character(sem),   
    "Final Estimate Type"    , as.character("EAP"),   
    "95% C.I."               , as.character(x95),
    "90% C.I."               , as.character(x90),
    "68% C.I."               , as.character(x68),
    "Test Length"            , as.character(nrow(valid)),
    "Items completed"        , as.character(nrow(completed)),
    "Items marked NA"        , as.character(sum(is.na(completed$response_num)))
  )



short = params$v$results %>%
  dplyr::arrange(order) %>%
  tidyr::drop_na(response) %>%
  dplyr::mutate(obs = ifelse(is.na(response_num), 0, 1)) %>%
  dplyr::mutate(m = cumsum(obs)) %>%
  dplyr::filter(m == 12) %>%
  dplyr::mutate(theta = round(theta, 2), sem = round(sem, 2))

total_short = params$v$results %>%
  dplyr::arrange(order) %>%
  tidyr::drop_na(response) %>%
  dplyr::mutate(obs = ifelse(is.na(response_num), 0, 1),
         m = cumsum(obs)) %>%
  dplyr::filter(m <= 12) 

valid_short = params$v$results %>%
  dplyr::arrange(order) %>%
  tidyr::drop_na(response) %>%
  dplyr::mutate(obs = ifelse(is.na(response_num), 0, 1),
         m = cumsum(obs)) %>%
  dplyr::filter(m <= 12) %>%
  tidyr::drop_na(response_num)

theta_short = short$theta
sem_short = short$sem
z_short = (theta_short-50)/10
ab_short = ifelse(z_short>=0, "above", "below")

x95_short = glue::glue("{round(theta_short-1.96  *sem_short, 2)}, {round(theta_short+1.96  *sem_short, 2)}")
x90_short = glue::glue("{round(theta_short-1.645 *sem_short, 2)}, {round(theta_short+1.645 *sem_short, 2)}")
x68_short = glue::glue("{round(theta_short-1     *sem_short, 2)}, {round(theta_short+1     *sem_short, 2)}")

table2 = tibble::tribble(
  ~"label", ~"score",
  "Final T-Score Estimate" , as.character(theta_short),
  "Final Standard Error"   , as.character(sem_short),   
  "Final Estimate Type"    , as.character("EAP"),   
  "95% C.I."               , as.character(x95_short),
  "90% C.I."               , as.character(x90_short),
  "68% C.I."               , as.character(x68_short),
  "Test Length"            , as.character(nrow(valid_short)),
  "Items completed"        , as.character(nrow(total_short)),
  "Items marked NA"        , as.character(sum(is.na(total_short$response_num)))
)

```

### Summary

This individual's T-score estimate of `r theta` (95% confidence interval: `r x95`) 
indicates self-reported communicative functioning approximately `r round(abs(z), 2)` standard 
deviations `r ab` the mean reported in a large reference sample of community-dwelling
persons with aphasia of at least one month post-onset.

T-scores are scaled such that the mean and standard deviation in the reference
sample are 50 and 10, respectively. Given that the scores in the reference sample
were approximately normally distributed, roughly 68% of scores drawn from the
population are expected to fall between 40 and 60, and roughly 5% are expected
to be lower than 30 or greater than 70.

The confidence interval expresses the uncertainty in the score estimate,
with wider intervals at a given confidence level indicating 
greater uncertainty. If the test could be administered to this individual
a large number of times under identical conditions, 95 out of 100 of the
of 95% confidence intervals would contain the true value of the communicative
functioning score.


ID: `r unique(params$v$results$participant)`  
Examiner: `r unique(params$v$results$examiner)`  
Date: `r params$dt`  
Item parameter set: January2015_59ItemParamSet

<br>

**Test: Adaptive ACOM with `r params$v$test_length` items administered.**

```{r, echo = FALSE}
knitr::kable(table1, booktabs = TRUE, col.names = NULL)
```

**Test: 12-item Adaptive ACOM short form**

```{r, echo = FALSE}
knitr::kable(table2, booktabs = TRUE, col.names = NULL)
```

### About this report

This report was downloaded on `r params$dt` and generated by the ACOM shiny web app located at https://rb-cavanaugh.shinyapps.io/acom/. This web-app is open source and the source code is located at https://github.com/rbcavanaugh/acom. Comments, feedback, and bug-reports can be made on the github page: https://github.com/rbcavanaugh/acom/issues.

The app can be cited as: Cavanaugh, R., Swiderski, A.M., Hula, W.D. (2022). acom: The Aphasia Communication Outcome Measure. Version 4.0.0 Available from https://github.com/rbcavanaugh/acom.

```{r, echo = F}
shiny::setProgress(0.9)
```

### References

Doyle, P. J., McNeil, M. R., Le, K., Hula, W. D., & Ventura, M. B. (2008). Measuring communicative functioning in community‐dwelling stroke survivors: Conceptual foundation and item development. Aphasiology, 22(7–8), 718–728.

Hula, W. D., & Doyle, P. J. (2021). The Aphasia Communication Outcome Measure: Motivation, development, validity evidence, and interpretation of change scores. Seminars in Speech and Language, 42(03), 211–224.

Hula, W. D., Doyle, P. J., Stone, C. A., Austermann Hula, S. N., Kellough, S., Wambaugh, J. L., Ross, K. B., Schumacher, J. G., & St. Jacque, A. (2015). The Aphasia Communication Outcome Measure (ACOM): Dimensionality, item bank calibration, and initial validation. Journal of Speech Language and Hearing Research, 58(3), 906.

Hula, W. D., Kellough, S., & Doyle, P. J. (2015). Reliability and validity of adaptive and static short forms of the Aphasia Communication Outcome Measure. Presentation to the Clinical Aphaisology Conference, Monterey, CA.
